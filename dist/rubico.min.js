/**
 * rubico v1.9.6
 * https://github.com/a-synchronous/rubico
 * (c) 2019-2021 Richard Tong
 * rubico may be freely distributed under the MIT license.
 */

!function(n,t){"object"==typeof module?module.exports=t:"function"==typeof define?define((()=>t)):n.rubico=t}("object"==typeof globalThis?globalThis:this,function(){"use strict";const n=function(){},t=n=>null!=n&&"function"==typeof n.then,e=(n,e)=>function(...o){const r=n(...o);return t(r)?r.then(e):e(r)},o=(n,t)=>function(...e){return t(n(...e))},r=Object.prototype.toString,u=n=>r.call(n),c=n=>"[object GeneratorFunction]"==u(n),f=n=>"[object AsyncGeneratorFunction]"==u(n),i=function(...t){const o=t.pop();if(t.length>0)return o.reduce(e)(...t);let r=n,u=n;return function(...t){const i=t[0];return"function"!=typeof i||c(i)||f(i)?(r==n&&(r=o.reduce(e)),r(...t)):(u==n&&(u=o.reduceRight(e)),u(i))}};i.sync=n=>n.reduce(o);const s=Array.isArray,l=Promise.all.bind(Promise),h=n=>function(){return n},a=Symbol.for("placeholder"),p=function(n,t,e,o){return t==a?((n,t,e)=>function(o){return n(o,t,e)})(n,e,o):e==a?((n,t,e)=>function(o){return n(t,o,e)})(n,t,o):((n,t,e)=>function(o){return n(t,e,o)})(n,t,e)},y=function(n,t,e){return n[t]=e,n},d=n=>function(...e){const o={},r=[];for(const u in n){const c=n[u](...e);t(c)?r.push(c.then(p(y,o,u,a))):o[u]=c}return 0==r.length?o:l(r).then(h(o))},g=function(n,t,e,o,r){return t==a?((n,t,e,o)=>function(r){return n(r,t,e,o)})(n,e,o,r):e==a?((n,t,e,o)=>function(r){return n(t,r,e,o)})(n,t,o,r):o==a?((n,t,e,o)=>function(r){return n(t,e,r,o)})(n,t,e,r):((n,t,e,o)=>function(r){return n(t,e,o,r)})(n,t,e,o)},w=async function(n,e,o,r){const u=n.length;for(;++r<u;){const u=n[r](...e);o[r]=t(u)?await u:u}return o},v=n=>s(n)?(n=>function(...e){const o=n.length,r=Array(o);let u=-1,c=!1;for(;++u<o;){const o=n[u](...e);t(o)&&(c=!0),r[u]=o}return c?l(r):r})(n):d(n);v.series=n=>s(n)?(n=>function(...o){const r=n.length,u=[];let c=-1;for(;++c<r;){const r=n[c](...o);if(t(r))return r.then(e(p(y,u,c,a),g(w,n,o,a,c)));u[c]=r}return u})(n):d(n);const b=Object.assign,j=n=>function(...t){return n(...t),t[0]},x=(n,t)=>function(){return n(...t)},M=(n,t,e)=>n?t():e(),S=n=>function(...e){const o=e[0],r=n(...e);return t(r)?r.then(h(o)):o};S.sync=j,S.if=(n,e)=>function(...o){const r=n(...o);if(t(r))return r.then(p(M,a,x(S(e),o),h(o[0])));if(r){const n=e(...o);if(t(n))return n.then(h(o[0]))}return o[0]};const O=function(n,t,e){return n(t,...e)},A=(n,t,e,o)=>function(){return n(t,e,o)},m=function(n,e,o){const r=n.length-1;for(;(o+=2)<r;){const r=n[o],u=n[o+1],c="function"==typeof r?r(...e):r;if(t(c))return c.then(p(M,a,"function"==typeof u?x(u,e):h(u),A(m,n,e,o)));if(c)return"function"==typeof u?u(...e):u}if(o==n.length)return;const u=n[r];return"function"==typeof u?u(...e):u},I=function(n){const t=n.length;let e=-1;for(;++e<t;)if("function"==typeof n[e])return!1;return!0},z=(n,t,e)=>function(){return n(t,e)},T=function(n,e){const o=n.length,r=o-1;for(;(e+=2)<r;){const o=n[e],r=n[e+1];if(t(o))return o.then(p(M,a,h(r),z(T,n,e)));if(o)return r}if(e!=o)return n[e]},E=Symbol.iterator,P=(n,t)=>({toString:()=>"[object MappingIterator]",[E](){return this},next(){const e=n.next();return e.done?e:{value:t(e.value),done:!1}}}),B=n=>({value:n,done:!1}),D=Symbol.asyncIterator,$=(n,e)=>({[D](){return this},async next(){const o=await n.next();if(o.done)return o;const r=e(o.value);return t(r)?r.then(B):{value:r,done:!1}}}),k=function(n,t,e){return t==a?((n,t)=>function(e){return n(e,t)})(n,e):((n,t)=>function(e){return n(t,e)})(n,t)},F=n=>{if(null==n)return!1;const t=typeof n;return"object"==t||"function"==t},C=function(n,e){const o=n.length,r=Array(o);let u=-1,c=!1;for(;++u<o;){const o=e(n[u],u,n);t(o)&&(c=!0),r[u]=o}return c?l(r):r},G=(n,t,e)=>n[t](e),_=function(n,e){const o=new Set,r=[];for(const u of n){const c=e(u,u,n);t(c)?r.push(c.then(p(G,o,"add",a))):o.add(c)}return 0==r.length?o:l(r).then(h(o))},q=(n,t,e,o)=>n[t](e,o),R=n=>new Promise((n=>function(e){const o={};let r=0;for(const u in n){const c=n[u];t(c)?(r+=1,c.then((n=>function(t){o[n]=t,r-=1,0==r&&e(o)})(u))):o[u]=c}0==r&&e(o)})(n)),V=function(n,e){const o={};let r=!1;for(const u in n){const c=e(n[u],u,n);t(c)&&(r=!0),o[u]=c}return r?R(o):o},H=async function(n,e,o,r){const u=n.length;for(;++r<u;){const u=e(n[r]);o[r]=t(u)?await u:u}return o},J=Promise.race.bind(Promise),K=async function(n,e,o,r,u,c){const f=n.length;for(;++u<f;){c.size>=o&&await J(c);const f=e(n[u]);if(t(f)){const n=f.then(j((()=>c.delete(n))));c.add(n),r[u]=n}else r[u]=f}return l(r)},L=Object.prototype.hasOwnProperty,N=(n,t)=>L.call(n,t),Q=(n,t,e)=>function(...o){const r=e.length,u=o.length,c=[];let f=-1,i=-1,s=0;for(;++f<r;){const r=e[f];if(r==a&&(i+=1)<u){const n=o[i];n==a&&(s+=1),c.push(n)}else c.push(r);if(c.length==n)return 0==s?t(...c):U(n,t,c)}for(;++i<u;){const e=o[i];if(e==a&&(s+=1),c.push(e),c.length==n)return 0==s?t(...c):U(n,t,c)}return U(n,t,c)},U=function(n,t,e){const o=e.length;if(o<n)return Q(n,t,e);let r=-1;for(;++r<o;){if(e[r]==a)return Q(n,t,e)}return t(...e)},W=n=>function([t,e]){return n(t,e)},X=function(n,t,e){return n.set(t,e)},Y=function(n,e){const o=new Map,r=[];return n.forEach(((n,e,o)=>function(r,u){const c=n([u,r]);t(c)?o.push(c.then(W(U(3,X,[e])))):e.set(c[0],c[1])})(e,o,r)),0==r.length?o:l(r).then(h(o))},Z=function(n,e){return s(n)?C(n,e):"function"==typeof n?c(n)?((n,t)=>function*(...e){for(const o of n(...e))yield t(o)})(n,e):f(n)?function(n,t){return async function*(...e){for await(const o of n(...e))yield t(o)}}(n,e):((n,e)=>function(o,r){const u=e(r);return t(u)?u.then(k(n,o,a)):n(o,u)})(n,e):null==n?n:"function"==typeof n.then?n.then(e):"function"==typeof n.map?n.map(e):"string"==typeof n||n.constructor==String?function(n,e){const o=C(n,e);return t(o)?o.then(p(G,a,"join","")):o.join("")}(n,e):n.constructor==Set?_(n,e):n.constructor==Map?function(n,e){const o=new Map,r=[];for(const[u,c]of n){const f=e(c,u,n);t(f)?r.push(f.then(g(q,o,"set",u,a))):o.set(u,f)}return 0==r.length?o:l(r).then(h(o))}(n,e):"function"==typeof n[E]?P(n[E](),e):"function"==typeof n[D]?$(n[D](),e):n.constructor==Object?V(n,e):e(n)},nn=(...n)=>{const t=n.pop();return n.length>0?Z(n[0],t):k(Z,a,t)};nn.entries=function(n){return function(e){if(null==e)throw new TypeError("value is not an Object or Map");if(e.constructor==Object)return function(n,e){const o={},r=[];for(const u in n){const c=e([u,n[u]]);t(c)?r.push(c.then(W(U(3,y,[o])))):o[c[0]]=c[1]}return 0==r.length?o:l(r).then(h(o))}(e,n);if(e.constructor==Map)return Y(e,n);throw new TypeError("value is not an Object or Map")}},nn.series=n=>function(o){if(s(o))return function(n,o){const r=n.length,u=Array(r);let c=-1;for(;++c<r;){const r=o(n[c]);if(t(r))return r.then(e(p(y,u,c,a),g(H,n,o,a,c)));u[c]=r}return u}(o,n);throw new TypeError(`${o} is not an Array`)},nn.pool=(n,e)=>function(o){if(s(o))return function(n,e,o){const r=n.length,u=Array(r);let c=-1;for(;++c<r;){const r=e(n[c]);if(t(r)){const t=new Set,f=r.then(j((()=>t.delete(f))));return t.add(f),u[c]=f,K(n,e,o,u,c,t)}u[c]=r}return u}(o,e,n);throw new TypeError(`${o} is not an Array`)},nn.withIndex=n=>function(e){if(s(e))return function(n,e){const o=n.length,r=Array(o);let u=-1,c=!1;for(;++u<o;){const o=e(n[u],u,n);t(o)&&(c=!0),r[u]=o}return c?l(r):r}(e,n);throw new TypeError(`${e} is not an Array`)},nn.own=n=>function(e){if(F(e)&&!s(e))return function(n,e){const o={};let r=!1;for(const u in n)if(N(n,u)){const c=e(n[u]);t(c)&&(r=!0),o[u]=c}return r?R(o):o}(e,n);throw new TypeError(`${e} is not an Object`)};const tn=(n,t)=>({[E](){return this},next(){let e=n.next();for(;!e.done;){const{value:o}=e;if(t(o))return{value:o,done:!1};e=n.next()}return e}}),en=(n,e)=>({isAsyncIteratorDone:!1,[D](){return this},async next(){for(;!this.isAsyncIteratorDone;){const{value:o,done:r}=await n.next();if(r)this.isAsyncIteratorDone=!0;else{const n=e(o);if(t(n)?await n:n)return{value:o,done:!1}}}return{value:void 0,done:!0}}}),on=function(n,t,e,o){const r=t.length;let u=n.length-1;for(;++o<r;)n[++u]=e(t[o],o,n);return n},rn=function(n,t,e,o){const r=n.length;let u=-1;for(;++e<r;)o[++u]&&t.push(n[e]);return t},un=function(n,e){const o=n.length,r=[];let u=-1,c=-1;for(;++u<o;){const o=n[u],f=e(o);if(t(f))return l(on([f],n,e,u)).then(g(rn,n,r,u-1,a));f&&(r[++c]=o)}return r},cn=(n,t)=>function(){return n(t)},fn=(n,t,e,o,r)=>function(){return n(t,e,o,r)},sn=function(n,t,e,o){o&&(n[t]=e)},ln=function(n,t,e,o){const r=t.length;let u=n.length-1;for(;++o<r;)n[++u]=e(t[o],o,t);return n},hn=function(e,o){return s(e)?un(e,o):"function"==typeof e?c(e)?((n,t)=>function*(...e){yield*tn(n(...e),t)})(e,o):f(e)?((n,t)=>async function*(...e){yield*en(n(...e),t)})(e,o):((n,e)=>function(o,r){const u=e(r);return t(u)?u.then(p(M,a,z(n,o,r),h(o))):u?n(o,r):o})(e,o):null==e?e:"string"==typeof e||e.constructor==String?function(n,e){const o=un(n,e);return t(o)?o.then(p(G,a,"join","")):o.join("")}(e,o):e.constructor==Set?function(e,o){const r=new Set,u=r.add.bind(r),c=[];for(const f of e){const i=o(f,f,e);t(i)?c.push(i.then(p(M,a,cn(u,f),n))):i&&r.add(f)}return 0==c.length?r:l(c).then(h(r))}(e,o):e.constructor==Map?function(e,o){const r=new Map,u=[];for(const[c,f]of e){const i=o(f,c,e);t(i)?u.push(i.then(p(M,a,fn(q,r,"set",c,f),n))):i&&r.set(c,f)}return 0==u.length?r:l(u).then(h(r))}(e,o):"function"==typeof e.filter?e.filter(o):"function"==typeof e[E]?tn(e[E](),o):"function"==typeof e[D]?en(e[D](),o):e.constructor==Object?function(n,e){const o={},r=[];for(const u in n){const c=n[u],f=e(c,u,n);t(f)?r.push(f.then(g(sn,o,u,n[u],a))):f&&(o[u]=c)}return 0==r.length?o:l(r).then(h(o))}(e,o):e},an=function(...n){const t=n.pop();return n.length>0?hn(n[0],t):k(hn,a,t)};an.withIndex=n=>function(e){if(s(e))return function(n,e){const o=n.length,r=[];let u=-1,c=-1;for(;++u<o;){const o=n[u],f=e(o,u,n);if(t(f))return l(ln([f],n,e,u)).then(g(rn,n,r,u-1,a));f&&(r[++c]=o)}return r}(e,n);throw new TypeError(`${e} is not an Array`)};const pn=function(n,t,e,o){return t==a?((n,t,e)=>function(...o){return n(o,t,e)})(n,e,o):e==a?((n,t,e)=>function(...o){return n(t,o,e)})(n,t,o):((n,t,e)=>function(...o){return n(t,e,o)})(n,t,e)},yn=Object.values,dn=async function(n,e,o){let r=n.next();if(r.done)return o;for(;!r.done;)o=e(o,r.value),t(o)&&(o=await o),r=n.next();return o},gn=function(n,e,o){let r=n.next();if(r.done)return o;for(void 0===o&&(o=r.value,r=n.next());!r.done;){if(o=e(o,r.value),t(o))return o.then(p(dn,n,e,a));r=n.next()}return o},wn=async function(n,t,e){let o=await n.next();if(o.done)return e;for(void 0===e&&(e=o.value,o=await n.next());!o.done;)e=await t(e,o.value),o=await n.next();return e},vn=async function(n,e,o,r){const u=n.length;for(;++r<u;)o=e(o,n[r],r,n),t(o)&&(o=await o);return o},bn=Object.keys,jn=async function(n,e,o,r,u){const c=r.length;for(;++u<c;){const c=r[u];o=e(o,n[c],c,n),t(o)&&(o=await o)}return o},xn=async function(n,e,o,r){for(const[u,c]of r)o=e(o,c,u,n),t(o)&&(o=await o);return o},Mn=(n,e)=>function(o,r){const u=n(o,r);return t(u)?u.then(k(e,a,r)):e(u,r)},Sn=function(n,e,r){const u=n[0];return s(u)?function(n,e,o){const r=n.length;let u=-1;for(void 0===o&&(o=n[++u]);++u<r;)if(o=e(o,n[u],u,n),t(o))return o.then(g(vn,n,e,a,u));return o}(u,e,r):"function"==typeof u?c(u)?((n,t,e)=>o(n,p(gn,a,t,e)))(u,e,r):f(u)?((n,t,e)=>o(n,p(wn,a,t,e)))(u,e,r):pn(Sn,a,1==n.length?Mn(e,u):n.reduce(Mn,e),r):null==u?void 0===r?k(e,u,a):e(r,u):u.constructor==Map?function(n,e,o){const r=n.entries();if(void 0===o){const n=r.next();if(n.done)return o;o=n.value[1]}for(const[u,c]of r)if(o=e(o,c,u,n),t(o))return o.then(g(xn,n,e,a,r));return o}(u,e,r):"function"==typeof u[E]?gn(u[E](),e,r):"function"==typeof u[D]?wn(u[D](),e,r):"function"==typeof u.reduce?u.reduce(e,r):"function"==typeof u.chain?u.chain(k(e,r,a)):"function"==typeof u.flatMap?u.flatMap(k(e,r,a)):u.constructor==Object?function(n,e,o){const r=bn(n),u=r.length;let c=-1;for(void 0===o&&(o=n[r[++c]]);++c<u;){const u=r[c];if(o=e(o,n[u],u,n),t(o))return o.then((f=jn,s=e,l=a,h=r,p=c,(i=n)==a?((n,t,e,o,r)=>function(u){return n(u,t,e,o,r)})(f,s,l,h,p):s==a?((n,t,e,o,r)=>function(u){return n(t,u,e,o,r)})(f,i,l,h,p):l==a?((n,t,e,o,r)=>function(u){return n(t,e,u,o,r)})(f,i,s,h,p):h==a?((n,t,e,o,r)=>function(u){return n(t,e,o,u,r)})(f,i,s,l,p):((n,t,e,o,r)=>function(u){return n(t,e,o,r,u)})(f,i,s,l,h)))}var f,i,s,l,h,p;return o}(u,e,r):void 0===r?k(e,u,a):e(r,u)},On=ArrayBuffer.isView,An=(n,t)=>n+t,mn=function(n,t){return null!=(e=t)&&e.length>0?function(n,t){const e=n.length,o=t.length;let r=-1;for(;++r<o;)n[e+r]=t[r];return n}(n,t):(n.push(t),n);var e},In="function"==typeof Buffer,zn=In?Buffer.alloc:n,Tn=function(n,t){const e=n.length,o=In&&n.constructor==Buffer?zn(e+t.length):new n.constructor(e+t.length);return o.set(n),o.set(t,e),o},En=function(n,t){return s(t)||On(t)?Tn(n,t):Tn(n,[t])},Pn=(n,t)=>new Promise(((n,t)=>function(e,o){t.on("data",(n=>function(t,e,o){return n.write(t,e,o),n})(n)),t.on("end",cn(e,n)),t.on("error",o)})(n,t)),Bn=function(n,t){return null!=(e=t)&&"function"==typeof e.pipe?Pn(n,t):(n.write(t),n);var e},Dn=function(n,t){if(null!=t&&t.constructor==Set){for(const e of t)n.add(e);return n}return n.add(t)},$n=function(n,t){return n.concat(t)},kn=function(e,o,r){const u=Sn(e,o(n),null);return t(u)?u.then(h(r)):r},Fn=function(n,e,o){if(s(o))return Sn(n,e(mn),o);if(On(o)){const r=Sn(n,e(mn),[]);return t(r)?r.then(k(En,o,a)):En(o,r)}if(null==o)return kn(n,e,o);const r=o.constructor;return"string"==typeof o||r==String?Sn(n,e(An),o):"function"==typeof o.concat?Sn(n,e($n),o):"function"==typeof o.write?Sn(n,e(Bn),o):r==Set?Sn(n,e(Dn),o):r==Object?Sn(n,e(b),o):kn(n,e,o)},Cn=function(n,t){return n.push(t),n},Gn=function(n,t){let e=[],o=0;return{[E](){return this},next(){if(o<e.length){const n=e[o];return o+=1,{value:n,done:!1}}const r=n.next();if(r.done)return r;const u=Sn([t(r.value)],Cn,[]);return u.length>1&&(e=u,o=1),{value:u[0],done:!1}}}},_n=n=>new Promise((t=>{setTimeout(t,n)})),qn=function(n,e){const o=[],r=new Set;return{isAsyncIteratorDone:!1,[D](){return this},toString:()=>"[object FlatMappingAsyncIterator]",async next(){for(;!this.isAsyncIteratorDone||o.length>0||r.size>0;){if(!this.isAsyncIteratorDone){const{value:u,done:c}=await n.next();if(c)this.isAsyncIteratorDone=c;else{const n=e(u);if(t(n)){const t=n.then(pn(Sn,a,Cn,o)).then((()=>r.delete(t)));r.add(t)}else{const e=Sn([n],Cn,o);if(t(e)){const n=e.then((()=>r.delete(n)));r.add(n)}}}}if(o.length>0)return{value:o.shift(),done:!1};r.size>0&&await J([_n(1e3),...r])}return{value:void 0,done:!0}}}},Rn=(n,t)=>t,Vn=n=>n,Hn=async function(n,e){const o=[];for await(const r of n){const n=e(r);t(n)&&o.push(n)}return 0==o.length?n:l(o).then(h(n))},Jn=function(n){const e=n.length,r=[],u=[];let c=-1;for(;++c<e;){const e=n[c];if(s(e)){const n=e.length;let t=-1;for(;++t<n;)u.push(e[t])}else if(null==e)u.push(e);else if("function"==typeof e.then)r.push(e.then(k(Cn,u,a)));else if("function"==typeof e[E])for(const n of e)u.push(n);else if("function"==typeof e[D])r.push(Hn(e[D](),k(Cn,u,a)));else if("function"==typeof e.chain){const n=e.chain(Vn);t(n)?r.push(n.then(k(Cn,u,a))):u.push(n)}else if("function"==typeof e.flatMap){const n=e.flatMap(Vn);t(n)?r.push(n.then(k(Cn,u,a))):u.push(n)}else if("function"==typeof e.reduce){const n=e.reduce(o(Rn,k(Cn,u,a)),null);t(n)&&r.push(n)}else if(e.constructor==Object)for(const n in e)u.push(e[n]);else u.push(e)}return 0==r.length?u:l(r).then(h(u))},Kn=function(n){const e=[],r={},u=k(b,r,a),c=o(Rn,u);for(const o in n){const f=n[o];if(null!=f)if("function"==typeof f[E])for(const n of f)b(r,n);else if("function"==typeof f[D])e.push(Hn(f[D](),u));else if("function"==typeof f.chain){const n=f.chain(Vn);t(n)?e.push(n.then(u)):b(r,n)}else if("function"==typeof f.flatMap){const n=f.flatMap(Vn);t(n)?e.push(n.then(u)):u(n)}else if("function"==typeof f.reduce){const n=f.reduce(c,null);t(n)&&e.push(n)}else b(r,f)}return 0==e.length?r:l(e).then((()=>r))},Ln=function(n){n.size;const e=[],o=new Set,r=(n,t)=>o.add(t),u=p(G,o,"add",a);for(const c of n)if(s(c)){const n=c.length;let t=-1;for(;++t<n;)o.add(c[t])}else if(null==c)o.add(c);else if("function"==typeof c[E])for(const n of c)o.add(n);else if("function"==typeof c[D])e.push(Hn(c[D](),u));else if("function"==typeof c.chain){const n=c.chain(Vn);t(n)?e.push(n.then(u)):o.add(n)}else if("function"==typeof c.flatMap){const n=c.flatMap(Vn);t(n)?e.push(n.then(u)):o.add(n)}else if("function"==typeof c.reduce){const n=c.reduce(r,null);t(n)&&e.push(n)}else if(c.constructor==Object)for(const n in c)o.add(c[n]);else o.add(c);return 0==e.length?o:l(e).then((()=>o))},Nn=e(Jn,k(((n,t)=>n.join(t)),a,"")),Qn=function(n,t,e,o){return n.write(t,e,o),n},Un=async function(n,e){const r=k(Qn,n,a),u=o(Rn,r),c=[];if(s(e)){const t=e.length;let o=-1;for(;++o<t;)n.write(e[o])}else if(null==e)n.write(e);else if("function"==typeof e[E])for(const t of e)n.write(t);else if("function"==typeof e[D])c.push(Hn(e[D](),r));else if("function"==typeof e.chain){const o=e.chain(Vn);t(o)?c.push(o.then(r)):n.write(o)}else if("function"==typeof e.flatMap){const o=e.flatMap(Vn);t(o)?c.push(o.then(r)):n.write(o)}else if("function"==typeof e.reduce){const n=e.reduce(u,null);t(n)&&c.push(n)}else if(e.constructor==Object)for(const t in e)n.write(e[t]);else n.write(e);return 0==c.length?n:l(c).then(h(n))},Wn=function(n,t){const e=n.length;let o=-1,r=t;for(;++o<e;)r=En(r,n[o]);return r},Xn=function(n,e){const o=Jn(n);return t(o)?o.then(k(Wn,a,e)):Wn(o,e)},Yn=function(n){const t=n.then((n=>[n,t]));return t},Zn=async function(n,e,o,r){const u=n.length;for(;++o<u;){const u=e(n[o]);if(t(u))r.add(Yn(u));else if(u)return!0}for(;r.size>0;){const[n,t]=await J(r);if(r.delete(t),n)return!0}return!1},nt=function(n,e){const o=n.length;let r=-1;for(;++r<o;){const o=e(n[r]);if(t(o))return Zn(n,e,r,new Set([Yn(o)]));if(o)return!0}return!1},tt=async function(n,e,o,r=20){let u=n.next();for(t(u)&&(u=await u);!u.done;){if(o.size>=r){const[n,t]=await J(o);if(o.delete(t),n)return!0}const c=e(u.value);if(t(c))o.add(Yn(c));else if(c)return!0;u=n.next(),t(u)&&(u=await u)}for(;o.size>0;){const[n,t]=await J(o);if(o.delete(t),n)return!0}return!1},et=function(n,e){const o=n.length,r=[];let u=-1;for(;++u<o;){const o=e(n[u]);if(t(o))r.push(o);else if(!o)return!1}return 0==r.length||l(r).then(p(G,a,"every",Boolean))},ot=(n,t,e)=>!!t&&n(e),rt=function(n,e){const o=n.length;for(;++e<o;){let o=n[e];if(t(o))return o.then(p(M,a,z(rt,n,e),h(!1)));if(!o)return!1}return!0},ut=async function(n,e,o){const r=n.length;for(;++o<r;){let r=n[o];if("function"==typeof r&&(r=r(e)),t(r)&&(r=await r),!r)return!1}return!0},ct=function(n,e){const o=n.length;for(;++e<o;){let o=n[e];if(t(o))return o.then(p(M,a,h(!0),z(ct,n,e)));if(o)return!0}return!1},ft=async function(n,e,o){const r=n.length;for(;++o<r;){let r=n[o];if("function"==typeof r&&(r=r(e)),console.log("hey - or",r),t(r)&&(r=await r),r)return!0}return!1},it=n=>!n,st=function(n){return"function"==typeof n?function(e){const o=n(e);return t(o)?o.then(it):!o}:!n};st.sync=n=>function(...t){return!n(...t)};const lt=function(n,t){return n===t||n!=n&&t!=t},ht=(n,t)=>n>t,at=(n,t)=>n<t,pt=(n,t)=>n>=t,yt=(n,t)=>n<=t,dt=/[.|[|\]]+/,gt=function(n,t){const e=new Map,o=function(o){if(e.has(o))return e.get(o);const r=n(o);return e.set(o,r),e.size>t&&e.clear(),r};return o.cache=e,o}((function(n){const t=n.length-1,e="["==n[0],o="]"==n[t];return e&&o?n.slice(1,t).split(dt):e?n.slice(1).split(dt):o?n.slice(0,t).split(dt):n.split(dt)}),500),wt=n=>s(n)?n:"string"==typeof n?gt(n):[n],vt=function(n,t){const e=wt(t),o=e.length;let r=-1,u=n;for(;++r<o;)if(u=u[e[r]],null==u)return;return u},bt=function(n,t,e){if(!F(n))return n;const o=wt(e),r=o.length,u=r-1,c={...n};let f=c,i=-1;for(;++i<r;){const n=o[i];if(i==u)f[n]=t;else{const t=f[n],e=s(t)?t.slice():{...t};f[n]=e,f=e}}return c},jt=function(n,t){if(null==n)return;const e=wt(t),o=e.length-1;let r=-1,u=n;for(;++r<o;)if(u=u[e[r]],null==u)return;const c=e[r];null!=u&&c in u&&delete u[c]},xt=function(n){const t={};for(const e in n){const o=n[e];s(o)?t[e]=Mt(o):null!=o&&o.constructor==Object?t[e]=xt(o):t[e]=o}return t},Mt=function(n){const t=n.length,e=[];let o=-1;for(;++o<t;){const t=n[o];s(t)?e[o]=Mt(t):null!=t&&t.constructor==Object?e[o]=xt(t):e[o]=t}return e},St=(n,...t)=>U(n.length,n,t);St.arity=function(n,t,...e){return U(n,t,e)};const Ot={pipe:i,tap:S,switchCase:n=>I(n)?T(n,-2):function(...t){return m(n,t,-2)},tryCatch:function(...n){if(n.length>2){const e=n.pop(),o=n.pop();try{const r=o(...n);return t(r)?r.catch(p(O,e,a,n)):r}catch(t){return e(t,...n)}}const e=n[0],o=n[1];return function(...n){try{const r=e(...n);return t(r)?r.catch(p(O,o,a,n)):r}catch(t){return o(t,...n)}}},fork:v,assign:function(n){const e=d(n);return function(n){const o=e(n);return t(o)?o.then(p(b,{},n,a)):{...n,...o}}},get:(n,t)=>function(e){const o=null==e?void 0:vt(e,n);return void 0===o?"function"==typeof t?t(e):t:o},set:(n,e)=>function(o){if("function"==typeof e){const r=e(o);return t(r)?r.then(p(bt,o,a,n)):bt(o,r,n)}return bt(o,e,n)},pick:n=>function(t){if(null==t)return t;const e=n.length;let o={},r=-1;for(;++r<e;){const e=n[r],u=vt(t,e);null!=u&&(o=bt(o,u,e))}return o},omit:n=>function(t){const e=n.length,o=s(r=t)?Mt(r):null==r?r:r.constructor==Object?xt(r):r;var r;let u=-1;for(;++u<e;)jt(o,n[u]);return o},map:nn,filter:an,reduce:function(...n){if("function"!=typeof n[0]){const t=n[1],e=n[2];return Sn([n[0]],t,"function"==typeof e?e(n[0]):e)}const e=n[0],o=n[1];return"function"==typeof o?function(...n){const r=o(...n);return t(r)?r.then(p(Sn,n,e,a)):Sn(n,e,r)}:pn(Sn,a,e,o)},transform:function(n,e){return"function"==typeof e?function(...o){const r=e(...o);return t(r)?r.then(p(Fn,o,n,a)):Fn(o,n,r)}:function(...t){return Fn(t,n,e)}},flatMap:n=>function(e){if(s(e))return function(n,e){const o=C(n,e);return t(o)?o.then(Jn):Jn(o)}(e,n);if("function"==typeof e)return c(e)?((n,t)=>function*(...e){yield*Gn(n(...e),t)})(e,n):f(e)?((n,t)=>async function*(...e){yield*qn(n(...e),t)})(e,n):((n,e)=>function(o,r){const u=e(r);return t(u)?u.then(pn(Sn,a,n,o)):Sn([u],n,o)})(e,n);if(On(e))return function(n,e){const o=C(n,e),r=In&&n.constructor==Buffer?zn(0):new n.constructor(0);return t(o)?o.then(k(Xn,a,r)):Xn(o,r)}(e,n);if(null==e)return n(e);if("function"==typeof e.then)return e.then(n);if("function"==typeof e.next)return E in e?Gn(e,n):qn(e,n);if("function"==typeof e.chain)return e.chain(n);if("function"==typeof e.flatMap)return e.flatMap(n);if("function"==typeof e[D]&&"function"==typeof e.write)return async function(n,e){const o=new Set;for await(const r of n){const u=e(r);if(t(u)){const t=u.then(k(Un,n,a)).then((()=>o.delete(t)));o.add(t)}else{const e=Un(n,u);if(t(e)){const n=e.then((()=>o.delete(n)));o.add(n)}}}return await l(o),n}(e,n);const o=e.constructor;return o==Object?function(n,e){const o=V(n,e);return t(o)?o.then(Kn):Kn(o)}(e,n):o==Set?function(n,e){const o=_(n,e);return t(o)?o.then(Ln):Ln(o)}(e,n):"string"==typeof e||o==String?function(n,e){const o=C(n,e);return t(o)?o.then(Nn):Nn(o)}(e,n):n(e)},and:n=>I(n)?rt(n,-1):function(e){const o=n.length;let r=-1;for(;++r<o;){let o=n[r];if("function"==typeof o&&(o=o(e)),t(o))return o.then(p(M,a,A(ut,n,e,r),h(!1)));if(!o)return!1}return!0},or:n=>I(n)?ct(n,-1):function(e){const o=n.length;let r=-1;for(;++r<o;){let o=n[r];if("function"==typeof o&&(o=o(e)),t(o))return o.then(p(M,a,h(!0),A(ft,n,e,r)));if(o)return!0}return!1},not:st,any:n=>function(e){return s(e)?nt(e,n):null==e?n(e):"function"==typeof e[E]?function(n,e){for(const o of n){const r=e(o);if(t(r))return tt(n,e,new Set([Yn(r)]));if(r)return!0}return!1}(e[E](),n):"function"==typeof e[D]?tt(e[D](),n,new Set):"function"==typeof e.reduce?e.reduce((n=>function(e,o){return!0===e?e:t(e)?e.then(k((n=>function(t,e){return!!t||n(e)})(n),a,o)):!!e||n(o)})(n),!1):e.constructor==Object?nt(yn(e),n):n(e)},all:n=>function(e){return s(e)?et(e,n):null==e?n(e):"function"==typeof e[E]?function(n,e){const o=[];for(const r of n){const n=e(r);if(t(n))o.push(n);else if(!n)return!1}return 0==o.length||l(o).then(p(G,a,"every",Boolean))}(e[E](),n):"function"==typeof e[D]?async function(n,e,o,r=20){let u=await n.next();for(;!u.done;){if(o.size>=r){const[n,t]=await J(o);if(o.delete(t),!n)return!1}const c=e(u.value);if(t(c))o.add(Yn(c));else if(!c)return!1;u=await n.next()}for(;o.size>0;){const[n,t]=await J(o);if(o.delete(t),!n)return!1}return!0}(e[D](),n,new Set):"function"==typeof e.reduce?e.reduce((n=>function(e,o){return!1!==e&&(t(e)?e.then(p(ot,n,a,o)):!!e&&n(o))})(n),!0):e.constructor==Object?et(yn(e),n):n(e)},eq:function(n,e){const o="function"==typeof n,r="function"==typeof e;return o&&r?function(o){const r=n(o),u=e(o),c=t(r),f=t(u);return c&&f?l([r,u]).then(W(lt)):c?r.then(k(lt,a,u)):f?u.then(k(lt,r,a)):lt(r,u)}:o?function(o){const r=n(o);return t(r)?r.then(k(lt,a,e)):lt(r,e)}:r?function(o){const r=e(o);return t(r)?r.then(k(lt,n,a)):lt(n,r)}:lt(n,e)},gt:function(n,e){const o="function"==typeof n,r="function"==typeof e;return o&&r?function(o){const r=n(o),u=e(o),c=t(r),f=t(u);return c&&f?l([r,u]).then(W(ht)):c?r.then(k(ht,a,u)):f?u.then(k(ht,r,a)):r>u}:o?function(o){const r=n(o);return t(r)?r.then(k(ht,a,e)):r>e}:r?function(o){const r=e(o);return t(r)?r.then(k(ht,n,a)):n>r}:n>e},lt:function(n,e){const o="function"==typeof n,r="function"==typeof e;return o&&r?function(o){const r=n(o),u=e(o),c=t(r),f=t(u);return c&&f?l([r,u]).then(W(at)):c?r.then(k(at,a,u)):f?u.then(k(at,r,a)):r<u}:o?function(o){const r=n(o);return t(r)?r.then(k(at,a,e)):r<e}:r?function(o){const r=e(o);return t(r)?r.then(k(at,n,a)):n<r}:n<e},gte:function(n,e){const o="function"==typeof n,r="function"==typeof e;return o&&r?function(o){const r=n(o),u=e(o),c=t(r),f=t(u);return c&&f?l([r,u]).then(W(pt)):c?r.then(k(pt,a,u)):f?u.then(k(pt,r,a)):r>=u}:o?function(o){const r=n(o);return t(r)?r.then(k(pt,a,e)):r>=e}:r?function(o){const r=e(o);return t(r)?r.then(k(pt,n,a)):n>=r}:n>=e},lte:function(n,e){const o="function"==typeof n,r="function"==typeof e;return o&&r?function(o){const r=n(o),u=e(o),c=t(r),f=t(u);return c&&f?l([r,u]).then(W(yt)):c?r.then(k(yt,a,u)):f?u.then(k(yt,r,a)):r<=u}:o?function(o){const r=n(o);return t(r)?r.then(k(yt,a,e)):r<=e}:r?function(o){const r=e(o);return t(r)?r.then(k(yt,n,a)):n<=r}:n<=e},thunkify:(n,...t)=>function(){return n(...t)},always:h,curry:St,__:a};return Ot}());
